# Math 365 / Comp 365: Homework 2

### *Please bring a stapled hard copy of your answers to class, citing any collaborators.*

## Charles Zhang

### Problem 1

The function
```
f(x)=(cos(x))^2+sin(x)-1
```
has roots at both $\pi$ and $\pi/2$. 

a) Using the convergence properties we discussed in class, estimate how many iterations of the bisection method are necessary to find the accurate solution to eight correct decimal places, when we start with a bracketing interval of [2.5,3.5].

> $\frac{3.5-2.5}{2^{i+1}}<\frac{1}{2}\times10^{-8}$<br>
$\frac{1}{10^{-8}}<2^{i}$<br>
$\log 10^{8}<i\log2$<br>
$i>\frac{\log 10^{8}}{log2}=26.57542$<br>
$\therefore 27$ iterations of the bisection method are necessary to find the accurate solution to eight correct decimal places.

```{r}
log(10^8)/log(2)
```


b) Use your `bisect` function to see how many iterations it actually takes.

```{r}
f = function(x){
  return((cos(x))^2+sin(x)-1)
}
bisect = function(f,interval,tol=0.5*10^-10,max.its=40){
  history = rep(NA, max.its) 
  # Insert some code here
  a<-interval[1]
  b<-interval[2]
  if(f(a)*f(b)<0) {
    while((b-a)/2>tol | max.its>0){
      c=(b+a)/2
      max.its <- max.its-1
      if(f(c)==0){
        break
      } 
      if(f(c)*f(b)<0) {a<-c} 
      if(f(c)*f(a)<0) {b<-c}
      root=c
      history=c(history,c)
    }
  } else{
    stop("f(a)f(b)<0 not satisfied")
  }
  return(list(root=root,history=history[!is.na(history)]))
}
options(digits = 10) 
interval <- c(2.5,3.5)
out=bisect(f,interval,0.5e-8)
print(out$root)
print(out$history)
```

> The accurate solution to eight correct decimal places is 3.14159265, and it is determined in bisection method after 27 iterations.

c) By hand, compute a formula for Newton's iteration for this particular choice of $f(x)$; i.e., write a formula for $x_{i+1}$ in terms of $x_{i}$.

> \(x_{n+1}=x_{n}-\frac{f\left(x_{n}\right)}{f^{\prime}\left(x_{n}\right)} \quad n=0,1,2, \ldots\)<br>
\(\therefore x_{n+1}=x_{n}+\frac{\cos ^{2} x_{n}+\sin x_{n} -1}{-\sin (2 x_{n})+\cos x_{n}}\)

d) Set $x_0$ to 4.25, run 50 iterations of your Newton's formula from c) to compute $\{x_i\}_{i=0,1,\ldots,50}$, and compute $e_i=|x_i-\pi|$ for all $i$. When does the iteration converge? Now plot $e_i / e_{i-1}$ over all $i$ until convergence. What is the convergence order and rate to $\pi$?

```{r}

```


e) Repeat d) with $x_0$=1.5. What is the convergence order and rate to $\pi/2$? If your answer is different from d), explain why.

```{r}

```

### Problem 2
Computer Problem 7 from Section 1.1 of the book (involving a determinant). 

7. Use the Bisection Method to find the two real numbers \(x,\) within six correct decimal places, that make the determinant of the matrix
$$
A=\left[\begin{array}{llll}
{1} & {2} & {3} & {x} \\
{4} & {5} & {x} & {6} \\
{7} & {x} & {8} & {9} \\
{x} & {10} & {11} & {12}
\end{array}\right]
$$
equal to \(1000 .\) For each solution you find, test it by computing the corresponding determinant and reporting how many correct decimal places (after the decimal point) the determinant has when your solution \(x\) is used. (In Section \(1.2,\) we will call this the "backward error" " associated with the approximate solution.) 


```{r}
f=function(x){
  A<-cbind(c(1,4,7,x),c(2,5,x,10),c(3,x,8,11),c(x,6,9,12))
  return(det(A)-1000)
}
options(digits = 8) 
interval <- c(9,10)
out=bisect(f,interval)
print(out$root)
print(out$history)
```

> The first root is 9.708299

```{r}
x<-9.708299
f(x)+1000 # corresponding determinant 
f(x)
```

> Therefore, the determinant has to 3 correct decimal places.

```{r}
options(digits = 9) 
interval <- c(-18,-17)
out=bisect(f,interval)
print(out$root)
print(out$history)
```

> The second root is -17.188498.

```{r}
x<--17.188498
f(x)+1000 # corresponding determinant 
f(x)
```
> Therefore, the determinant has to 2 correct decimal places.


### Problem 3
Computer Problem 8 from Section 1.1 of the book (involving the Hilbert matrix)

8. The Hilbert matrix is the \(n \times n\) matrix whose ijth entry is \(1 /(i+j-1)\). Let \(A\) denote the
\(5 \times 5\) Hilbert matrix. Its largest eigenvalue is about \(1.567 .\) Use the Bisection Method to decide
how to change the upper left entry \(A_{11}\) to make the largest eigenvalue of \(A\) equal to \(\pi\).
Determine \(A_{11}\) within six correct decimal places. 

```{r message=FALSE, warning=FALSE}
require(Matrix)
A=Hilbert(5)

f=function(x){
  A[1,1]<-x
  return(det(A-pi*diag(1,5,5)))
}
options(digits = 7) 
interval <- c(0,10)
out=bisect(f,interval)
print(out$root)
print(out$history)

A[1,1]<-2.948011
max(eigen(A)$values)
```

> Use \(|\mathbf{A}-\lambda \cdot \mathbf{I}| = 0\) to calculate the eigenvalue, I got $A_{11} = 2.948011$ with the max eignevalue $\pi$.


### Problem 4
Write your own function to find square roots, using the idea that $sqrt(t)$ is a root of the function $f(x) = x^2 - t$, where $t$ is a positive number. Come up with an initial interval carefully inside your function. Make sure your function is commented, and use it to compute $\sqrt{4}, \sqrt{9}, \sqrt{16}$.

```{r}
my.sqrt=function(x){
  f=function(t){
    return(t^2-x)
  }
  return(bisect(f,c(0,10))$root)
}

my.sqrt(1)
my.sqrt(4)
my.sqrt(9)
my.sqrt(16)
```


### Problem 5

This problem involves solving the equation
$$ \frac{r^3(2r^2+5\epsilon^2)}{2(r^2+\epsilon^2)^{5/2}}=0.9$$
Use the value $\epsilon=0.1$. From the context of the problem, it's clear that $r$ must be positive and $r$ might be close to $\epsilon$. 

a. Use your bisection code to solve the equation for $r$. Give ten digits of accuracy and report the number of bisection steps you used. _Hint:_ the R command `options(digits = 12)` can be used to print lots of digits.

```{r}
f=function(r){
  return((r^3*(2*r^2+5*0.1^2))/(2*(r^2+0.1^2)^(5/2))-0.9)
}
options(digits=10)
(out=bisect(f,c(0,1)))
```


b. (From In-class Activity) Another method to determine the convergence order is to plot the log-log plot of the error data, i.e. plot $(\log e_i, \log e_{i+1})$. To see why, consider: 

- Turn the equation $e_{i+1}=Ce_i^q$ into a straight line by taking the log of both sides and manipulating the equation to look like $y=mx+b$.

- What do you notice about the slope of the straight line?

- Now, test that the bisection method for this data had linear convergence by plotting the log-log plot of the error data $(\log e_i, \log e_{i+1})$ and observing what the slope is (hint, the function `lm` can give the slope). Run your bisection code again and find a root correct to 15 digits; you may use this root as the "true root" in the error formula. Note, your plot will not be perfectly linear as this "true root" is actually just an approximation.
```{r}
options(digits=15)
(rout=bisect(f,c(0,1))$root)
```
```{r warning=FALSE}
(e<-(out$history-rout))
(log(e))
```


```{r warning=FALSE}
x=log(e[1])
y=log(e[2])
for (i in 2:(length(e)-1)) {
  x=c(x,log(e[i]))
  y=c(y,log(e[i+1]))
}
x
y

```


c. Implement the secant method for rootfinding (it is OK to modify your `bisect` code). Then use your secant code to solve for $r$. How many secant steps were used?

d. Create a log-log plot of the errors for the secant method. What does it seem like the convergence order is for this?








