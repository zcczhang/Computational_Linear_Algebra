# Math 365 / Comp 365: Homework 2

### *Please bring a stapled hard copy of your answers to class, citing any collaborators.*

## Charles Zhang

### Problem 1

The function
```
f(x)=(cos(x))^2+sin(x)-1
```
has roots at both $\pi$ and $\pi/2$. 

a) Using the convergence properties we discussed in class, estimate how many iterations of the bisection method are necessary to find the accurate solution to eight correct decimal places, when we start with a bracketing interval of [2.5,3.5].

> $\frac{3.5-2.5}{2^{i+1}}<\frac{1}{2}\times10^{-8}$<br>
$\frac{1}{10^{-8}}<2^{i}$<br>
$\log 10^{8}<i\log2$<br>
$i>\frac{\log 10^{8}}{log2}=26.57542$<br>
$\therefore 27$ iterations of the bisection method are necessary to find the accurate solution to eight correct decimal places.

```{r}
log(10^8)/log(2)
```


b) Use your `bisect` function to see how many iterations it actually takes.

```{r}
f = function(x){
  return((cos(x))^2+sin(x)-1)
}
bisect = function(f,interval,tol=0.5*10^-10,max.its=40){
  history = rep(NA, max.its) 
  # Insert some code here
  a<-interval[1]
  b<-interval[2]
  if(f(a)*f(b)<0) {
    while((a-b)/2>tol | max.its>0){
      c=(b+a)/2
      max.its <- max.its-1
      if(f(c)==0){
        break
      } 
      if(f(c)*f(b)<0) {a<-c} 
      if(f(c)*f(a)<0) {b<-c}
      root=c
      history=c(history,c)
    }
  }
  return(list(root=root,history=history[!is.na(history)]))
}
options(digits = 10) 
interval <- c(2.5,3.5)
out=bisect(f,interval)
print(out$root)
print(out$history)
```

> The accurate solution to eight correct decimal places is 3.14159265, and it is determined in bisection method after 27 iterations.

c) By hand, compute a formula for Newton's iteration for this particular choice of $f(x)$; i.e., write a formula for $x_{i+1}$ in terms of $x_{i}$.

> \(x_{n+1}=x_{n}-\frac{f\left(x_{n}\right)}{f^{\prime}\left(x_{n}\right)} \quad n=0,1,2, \ldots\)<br>
\(\therefore x_{n+1}=x_{n}+\frac{\cos ^{2} x_{n}+\sin x_{n} -1}{-\sin (2 x_{n})+\cos x_{n}}\)

d) Set $x_0$ to 4.25, run 50 iterations of your Newton's formula from c) to compute $\{x_i\}_{i=0,1,\ldots,50}$, and compute $e_i=|x_i-\pi|$ for all $i$. When does the iteration converge? Now plot $e_i / e_{i-1}$ over all $i$ until convergence. What is the convergence order and rate to $\pi$?

```{r}

```


e) Repeat d) with $x_0$=1.5. What is the convergence order and rate to $\pi/2$? If your answer is different from d), explain why.

```{r}

```

### Problem 2
Computer Problem 7 from Section 1.1 of the book (involving a determinant). 

7. Use the Bisection Method to find the two real numbers \(x,\) within six correct decimal places, that make the determinant of the matrix
$$
A=\left[\begin{array}{llll}
{1} & {2} & {3} & {x} \\
{4} & {5} & {x} & {6} \\
{7} & {x} & {8} & {9} \\
{x} & {10} & {11} & {12}
\end{array}\right]
$$
equal to \(1000 .\) For each solution you find, test it by computing the corresponding determinant and reporting how many correct decimal places (after the decimal point) the determinant has when your solution \(x\) is used. (In Section \(1.2,\) we will call this the "backward error" " associated with the approximate solution.) 

> \(\left|\begin{array}{llll}{1} & {2} & {3} & {x} \\ {4} & {5} & {x} & {6} \\ {7} & {x} & {8} & {9} \\ {x} & {10} & {11} & {12}\end{array}\right|=1000\)<br>
\(\therefore 1\left|\begin{array}{ccc}{5} & {x} & {6} \\ {x} & {8} & {9} \\ {10} & {11} & {12}\end{array}\right|-2\left|\begin{array}{ccc}{4} & {x} & {6} \\ {7} & {8} & {9} \\ {x} & {11} & {12}\end{array}\right|+3\left|\begin{array}{ccc}{4} & {5} & {6} \\ {7} & {x} & {9} \\ {x} & {10} & {12}\end{array}\right|-x\left|\begin{array}{ccc}{4} & {5} & {x} \\ {7} & {x} & {8} \\ {x} & {10} & {11}\end{array}\right|=1000\)
\(\therefore x^{4}-202 x^{2}+1404 x-2475=1000\)<br>
\(\therefore f(x)=x^{4}-202 x^{2}+1404 x-2475-1000\)

```{r}
f = function(x){
  return(x^4-202*x^2+1404*x-2475-1000)
}

options(digits = 8) 
interval <- c(9,10)
out=bisect(f,interval)
print(out$root)
print(out$history)
```

> The first root is 9.708299

```{r}
x<-9.708299
f(x)+1000 # corresponding determinant 
f(x)
```

> Therefore, the determinant has to 3 correct decimal places.

```{r}
options(digits = 9) 
interval <- c(-18,-17)
out=bisect(f,interval)
print(out$root)
print(out$history)
```

> The second root is -17.188498.

```{r}
x<--17.188498
f(x)+1000 # corresponding determinant 
f(x)
```
> Therefore, the determinant has to 2 correct decimal places.


### Problem 3
Computer Problem 8 from Section 1.1 of the book (involving the Hilbert matrix)

8. The Hilbert matrix is the \(n \times n\) matrix whose ijth entry is \(1 /(i+j-1)\). Let \(A\) denote the
\(5 \times 5\) Hilbert matrix. Its largest eigenvalue is about \(1.567 .\) Use the Bisection Method to decide
how to change the upper left entry \(A_{11}\) to make the largest eigenvalue of \(A\) equal to \(\pi\).
Determine \(A_{11}\) within six correct decimal places. 

```{r}
require(Matrix)
A=Hilbert(5)

max(eigen(A)$values)
```

> Use \(|\mathbf{A}-\lambda \cdot \mathbf{I}| = 0\) to calculate the eigenvalue






#### *Some hints for Problems 2 and 3:*

1. To bind rows together into a matrix:
```{r}
rbind(c(1,2,3,44),c(4,5,44,6),c(7,44,8,9),c(44,10,11,12)) 
```

2. If A is a matrix, then `det(A)` is its determinant

3. For Problem 3, make a function of `x` that puts `x` on the backward diagonal, computes its determinant, and subtracts 1000. Then use your `bisect` on this function.

4. For Problem 4, to get the Hilbert matrix, `H`, you can use the `Hilbert` function from the `Matrix` package. Here is an example of how to generate a Hilbert matrix and change the first entry:
```{r}
require(Matrix)
H=Hilbert(5)
H[1,1]=132
```

5. To get the maximum eigenvalue of a matrix `A`, use 
```
max(eigen(A)$values)
```
6. In R, your favorite irrational and transcendatal number is written as `pi`:
```{r}
pi
```


### Problem 4
Write your own function to find square roots, using the idea that $sqrt(t)$ is a root of the function $f(x) = x^2 - t$, where $t$ is a positive number. Come up with an initial interval carefully inside your function. Make sure your function is commented, and use it to compute $\sqrt{4}, \sqrt{9}, \sqrt{16}$.

```{r}
my.sqrt=function(x){
  f=function(t){
    return(t^2-x)
  }
  return(bisect(f,c(1,10))$root)
}
my.sqrt(4)
my.sqrt(9)
my.sqrt(16)
```


### Problem 5

This problem involves solving the equation
$$ \frac{r^3(2r^2+5\epsilon^2)}{2(r^2+\epsilon^2)^{5/2}}=0.9$$
Use the value $\epsilon=0.1$. From the context of the problem, it's clear that $r$ must be positive and $r$ might be close to $\epsilon$. 

a. Use your bisection code to solve the equation for $r$. Give ten digits of accuracy and report the number of bisection steps you used. _Hint:_ the R command **options(digits = 12)** can be used to print lots of digits.

b. Implement the secant method for rootfinding (it is OK to modify your `bisect` code). Then use your secant code to solve for $r$. How many secant steps were used?

c. Determine the order of convergence by making a log-log plot of the errors, observing linearity, and then determining slope.

